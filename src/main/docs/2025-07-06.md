# 객체 저장소(System Design: S3 Clone) 개요

## 1. 핵심 개념
- **객체(Object)**
    - 데이터(바이트 스트림)와 메타데이터(키-값 쌍), 고유 식별자로 구성됨
- **버킷(Bucket)**
    - 객체를 담는 최상위 네임스페이스. 이름은 전역(unique)하며 URI 경로(`/{bucket}/{key}`)로 접근
- **파일·블록 저장소 대비 장점**
    - 완전한 메타데이터 관리, 수평 확장성, HTTP 기반 CRUD(API) 지원

## 2. 주요 API 설계
- **PUT / GET / DELETE / HEAD**
    - RESTful 엔드포인트로 객체 생성·조회·삭제·메타정보 확인 구현
- **프리사인드 URL (Pre-signed URL)**
    - 시간 제한 권한 위임 방식, 버킷 정책 변경 없이 특정 객체에 제한적 접근 허용
    - `GET`·`PUT`·`HEAD` 메서드 지원, 최대 7일(콘솔은 12시간)

## 3. 메타데이터 관리
- **시스템 메타데이터**
    - 객체 생성일, 크기, ETag, 버전 ID 등 자동 관리
- **사용자 정의 메타데이터**
    - 커스텀 태그·헤더 삽입 가능, 애플리케이션별 색인·분류에 활용

## 4. 스토리지 계층 및 클래스
- **객체 구성**
    - 실제 데이터, 메타데이터, 고유 키로 구성된 불변(unmodifiable) 단위
- **스토리지 클래스**
    - Standard, Standard-IA, One Zone-IA, Glacier 등 비용·성능 균형 제공

## 5. 파티셔닝 & 확장성
- **해시 기반 파티셔닝**
    - `(버킷명 + 객체키)` 해시 값으로 메타데이터 파티션 분할, 파티션 크기 제한 시 자동 분할(resharding)
- **수평 확장**
    - 메타데이터 서비스와 저장 노드를 독립 운영·다중화

## 6. 복제 & 내구성
- **다중 AZ 복제**
    - 각 객체를 3개 이상 AZ에 복제, 99.999999999% 내구성 보장
- **장기 보관**
    - Glacier 계층으로 자동 전환·아카이브

## 7. 일관성 모델
- **쓰기 후 읽기 일관성(Read-After-Write)**
    - 신규 PUT/DELETE 직후 최신 내용 조회 보장
- **업데이트·삭제 시 최종 일관성(Eventual Consistency)**
    - overwrite나 delete 처리 후 캐시 반영 지연 발생 가능

## 8. 대용량 객체 처리
- **Multipart Upload**
    - 100 MB 이상은 파트 단위(최대 10,000개) 병렬 업로드 권장
    - 파트 실패 시 해당 파트만 재전송, 업로드 중단 없이 중단·재개 가능
    - 모든 파트 업로드 후 Complete 호출 시 합성

## 9. 보안 & 권한 관리
- **ACL & IAM 정책**
    - 버킷·객체 단위 접근 제어 가능
- **프리사인드 URL**
    - 임시 권한 부여, 토큰 기반 URL 생성·만료 관리

## 10. 버전 관리 & 라이프사이클
- **버전 관리(Versioning)**
    - 객체 overwrite 시 과거 버전 보존, 삭제 마커(Deletion Marker) 활용
- **라이프사이클 정책**
    - 일정 기간 후 스토리지 클래스 전환, 만료(삭제) 규칙 설정

## 11. 운영 고려사항
- **모니터링 & 로깅**
    - 액세스 로그, 서버 측 로깅, 지표(메트릭) 수집
- **장애 대응**
    - 파티션 스키마 변경, 네트워크 재시도, 백오프(backoff) 전략
- **비용 최적화**
    - 수명 주기 관리, 스토리지 계층 전환, 불필요한 버전·미완료 업로드 정리
